---
title: 使用校园内网和寝室宽带搭建出校器
date: 2016-06-09 13:53:35
tags: "零碎记录"
---
由于实验室用的出校器太坑了，恰好寝室未拨号状态下和实验室电脑是可以互通的，于是就打算利用寝室已有的宽带搭建一个自用出校器。
由于学校内网似乎会拦截VPN（后来试验过，内网的VPN工作良好），所以选用了Shadowsocks.
思路：让寝室一台笔记本同时连着wifi（连接外网）和有线（连接校园内网），并搭建ss服务器，实验室的电脑使用ss客户端连接寝室的电脑，从而不用收费的访问外网。
这个思路其实和使用ss翻墙是一个道理。
<!-- more -->
网络配置：
编辑/etc/network/interfaces
```bash
auto eno1
iface eno1 inet static
address 10.20.41.141
netmask 255.255.254.0

auto wlo1
iface wlo1 inet dhcp
wpa-ssid "wifi_name"
wpa-psk "password"
```
这一步为内网配置了静态ip，但是不设置网关，外网使用DHCP分配。
/etc/init.d/networking  restart后，此时已经同时能访问外网和内网了。
不过由于实验室所处的网段和寝室的还不同，所以需要自己再手动添加路由表。
使用ip route show可以查看当前的路由表
```bash
default via 192.168.1.253 dev wlo1
10.20.40.0/23 dev eno1 proto kernel scope link src 10.20.41.141
169.254.0.0/16 dev eno1 scope link metric 1000
192.168.1.0/24 dev wlo1 proto kernel scope link src 192.168.1.100
202.193.53.0/24 via 10.20.41.254 dev eno1
```
手动添加另一个网段的路由
```bash
sudo ip route add 202.193.53.0/24 via 10.20.41.254 dev eno1
```
之后运行ss服务器即可。
该方法在ununtu 16.04和树莓派上都尝试过可行。
